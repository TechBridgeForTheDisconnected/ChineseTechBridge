<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>科技橋梁</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    /* [Previous CSS styles remain exactly the same] */
    /* ... */
  </style>
</head>
<body>
  <!-- [Previous HTML content remains exactly the same until the scripts] -->
  <!-- ... -->

  <!-- Load Botpress script from their CDN -->
  <script src="https://cdn.botpress.cloud/webchat/v2/inject.js"></script>
  
  <!-- Initialize Webchat -->
  <script>
    // Tab functionality
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');

    tabButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        tabButtons.forEach(b => b.classList.remove('active'));
        tabContents.forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');
      });
    });

    // Feedback submission
    document.getElementById("feedbackForm").addEventListener("submit", function(e) {
      e.preventDefault();
      alert("感謝您的反饋！");
    });

    // Chatbot functionality
    const chatbotToggle = document.getElementById("chatbotToggle");
    let chatVisible = false;
    
    // Initialize Botpress Webchat with the correct configuration
    window.botpressWebChat.init({
      "botId": "d86f2e7d-be1d-40f5-a8bd-4c75c96ae22c",
      "clientId": "36fc36e6-f791-4b02-8086-58654242f322",
      "hostUrl": "https://cdn.botpress.cloud/webchat/v2",
      "messagingUrl": "https://messaging.botpress.cloud",
      "botName": "孫子機器人",
      "botDescription": "我是來幫助您像孫子一樣的人！",
      "composerPlaceholder": "請問有什麼需要協助？",
      "avatarUrl": "https://upload.wikimedia.org/wikipedia/commons/thumb/0/0e/Human-emblem-blue.svg/2048px-Human-emblem-blue.svg.png",
      "frontendVersion": "v2",
      "useSessionStorage": true,
      "theme": {
        "color": "#3B82F6",
        "backgroundColor": "#ffffff"
      },
      "hideWidget": true, // Start with widget hidden
      "disableAnimations": false,
      "showCloseButton": true,
      "enableTranscriptDownload": true
    }).then(() => {
      // Webchat is ready
      console.log("Botpress Webchat initialized successfully");
      
      // Toggle chatbot visibility
      chatbotToggle.addEventListener('click', function() {
        chatVisible = !chatVisible;
        
        if (chatVisible) {
          window.botpressWebChat.sendEvent({ type: 'show' });
          chatbotToggle.textContent = '關閉聊天機器人';
        } else {
          window.botpressWebChat.sendEvent({ type: 'hide' });
          chatbotToggle.textContent = '開啟聊天機器人';
        }
      });

      // Show chatbot when chat tab is clicked
      document.querySelector('[data-tab="chat"]').addEventListener('click', function() {
        window.botpressWebChat.sendEvent({ type: 'show' });
        chatbotToggle.textContent = '關閉聊天機器人';
        chatVisible = true;
      });
    }).catch(err => {
      console.error("Error initializing Botpress Webchat:", err);
      chatbotToggle.textContent = '聊天機器人載入失敗';
      chatbotToggle.style.backgroundColor = '#ef4444';
    });
  </script>
</body>
</html>
